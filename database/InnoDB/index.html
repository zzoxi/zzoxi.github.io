<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>mysql | zz学习笔记</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/zz.png">
    <meta name="description" content="个人学习总结">
    <meta name="keywords" content="Java,git,github,markdown">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.f86df05f.css" as="style"><link rel="preload" href="/assets/js/app.510ffd02.js" as="script"><link rel="preload" href="/assets/js/2.5c750f37.js" as="script"><link rel="preload" href="/assets/js/7.45caa363.js" as="script"><link rel="prefetch" href="/assets/js/10.ba94142f.js"><link rel="prefetch" href="/assets/js/11.a6f06463.js"><link rel="prefetch" href="/assets/js/12.790aa858.js"><link rel="prefetch" href="/assets/js/13.a1468cfe.js"><link rel="prefetch" href="/assets/js/14.6d352a6a.js"><link rel="prefetch" href="/assets/js/15.d61fff58.js"><link rel="prefetch" href="/assets/js/16.a266e7a3.js"><link rel="prefetch" href="/assets/js/3.c64a77ee.js"><link rel="prefetch" href="/assets/js/4.94dce7a4.js"><link rel="prefetch" href="/assets/js/5.b7b6a32b.js"><link rel="prefetch" href="/assets/js/6.d669c02f.js"><link rel="prefetch" href="/assets/js/8.3299d50c.js"><link rel="prefetch" href="/assets/js/9.4d9774c8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f86df05f.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/zz.png" alt="zz学习笔记" class="logo"> <span class="site-name can-hide">zz学习笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><!----> <span class="title" style="display:;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Java基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/basic/java/" class="nav-link">Java基础</a></li><li class="dropdown-subitem"><a href="/basic/bottle/" class="nav-link">Java容器</a></li></ul></li><li class="dropdown-item"><h4>JAVA进阶</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/advance/JVM/" class="nav-link">JVM虚拟机</a></li><li class="dropdown-subitem"><a href="/pages/44ebb8/" class="nav-link">JAVA并发编程</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><!----> <span class="title" style="display:;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>MySQL数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/database/MySQL/" class="nav-link">MySQL基本使用</a></li><li class="dropdown-subitem"><a href="/database/InnoDB/" aria-current="page" class="nav-link router-link-exact-active router-link-active">InnoDB引擎</a></li></ul></li><li class="dropdown-item"><h4>Redis数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/database/s/" class="nav-link">Redis基本使用</a></li><li class="dropdown-subitem"><a href="/database/b/" class="nav-link">Redis原理</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/banner.jpg"> <div class="blogger-info"><h3>zz</h3> <span>学习中</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><!----> <span class="title" style="display:;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Java基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/basic/java/" class="nav-link">Java基础</a></li><li class="dropdown-subitem"><a href="/basic/bottle/" class="nav-link">Java容器</a></li></ul></li><li class="dropdown-item"><h4>JAVA进阶</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/advance/JVM/" class="nav-link">JVM虚拟机</a></li><li class="dropdown-subitem"><a href="/pages/44ebb8/" class="nav-link">JAVA并发编程</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><!----> <span class="title" style="display:;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>MySQL数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/database/MySQL/" class="nav-link">MySQL基本使用</a></li><li class="dropdown-subitem"><a href="/database/InnoDB/" aria-current="page" class="nav-link router-link-exact-active router-link-active">InnoDB引擎</a></li></ul></li><li class="dropdown-item"><h4>Redis数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/database/s/" class="nav-link">Redis基本使用</a></li><li class="dropdown-subitem"><a href="/database/b/" class="nav-link">Redis原理</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>MySQL</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/database/InnoDB/" aria-current="page" class="active sidebar-link">mysql</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/database/InnoDB/#第一章-mysql简介" class="sidebar-link">第一章 MySQL简介</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/database/InnoDB/#_1-1-mysql体系结构" class="sidebar-link">1.1 MySQL体系结构</a></li><li class="sidebar-sub-header level3"><a href="/database/InnoDB/#_1-2-mysql存储引擎" class="sidebar-link">1.2 MySQL存储引擎</a></li><li class="sidebar-sub-header level4"><a href="/database/InnoDB/#innodb与myisam区别" class="sidebar-link">InnoDB与MyISAM区别</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/database/InnoDB/#第二章-innodb存储引擎" class="sidebar-link">第二章 InnoDB存储引擎</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/database/InnoDB/#_1-1-概述" class="sidebar-link">1.1 概述</a></li><li class="sidebar-sub-header level3"><a href="/database/InnoDB/#_2-3-innodb体系架构" class="sidebar-link">2.3 InnoDB体系架构</a></li><li class="sidebar-sub-header level4"><a href="/database/InnoDB/#后台线程" class="sidebar-link">后台线程</a></li><li class="sidebar-sub-header level4"><a href="/database/InnoDB/#内存池" class="sidebar-link">内存池</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/database/InnoDB/#文件" class="sidebar-link">文件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/database/InnoDB/#_3-1-参数文件" class="sidebar-link">3.1 参数文件</a></li><li class="sidebar-sub-header level3"><a href="/database/InnoDB/#_3-2-日志文件" class="sidebar-link">3.2 日志文件</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/database/InnoDB/#第四章-表" class="sidebar-link">第四章 表</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/database/InnoDB/#_4-1-索引组织表" class="sidebar-link">4.1 索引组织表</a></li><li class="sidebar-sub-header level3"><a href="/database/InnoDB/#_4-2-innodb逻辑存储结构" class="sidebar-link">4.2 InnoDB逻辑存储结构</a></li><li class="sidebar-sub-header level4"><a href="/database/InnoDB/#_4-2-1-表空间" class="sidebar-link">4.2.1 表空间</a></li><li class="sidebar-sub-header level4"><a href="/database/InnoDB/#_4-2-2-段" class="sidebar-link">4.2.2 段</a></li><li class="sidebar-sub-header level4"><a href="/database/InnoDB/#_4-2-3-区" class="sidebar-link">4.2.3 区</a></li><li class="sidebar-sub-header level4"><a href="/database/InnoDB/#_4-2-4-页" class="sidebar-link">4.2.4 页</a></li><li class="sidebar-sub-header level4"><a href="/database/InnoDB/#_4-2-5-行" class="sidebar-link">4.2.5 行</a></li><li class="sidebar-sub-header level3"><a href="/database/InnoDB/#_4-3-innodb行记录格式" class="sidebar-link">4.3 InnoDB行记录格式</a></li><li class="sidebar-sub-header level4"><a href="/database/InnoDB/#_4-3-3-行溢出数据" class="sidebar-link">4.3.3 行溢出数据</a></li><li class="sidebar-sub-header level4"><a href="/database/InnoDB/#_4-3-5-char的行结构存储" class="sidebar-link">4.3.5 CHAR的行结构存储</a></li><li class="sidebar-sub-header level3"><a href="/database/InnoDB/#_4-4-innodb数据页结构" class="sidebar-link">4.4 InnoDB数据页结构</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/database/InnoDB/#第五章-索引与算法" class="sidebar-link">第五章 索引与算法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/database/InnoDB/#_5-1-innodb索引概述" class="sidebar-link">5.1 InnoDB索引概述</a></li><li class="sidebar-sub-header level3"><a href="/database/InnoDB/#_5-2-数据结构与算法" class="sidebar-link">5.2 数据结构与算法</a></li><li class="sidebar-sub-header level3"><a href="/database/InnoDB/#_5-3-b-树" class="sidebar-link">5.3 B+树</a></li><li class="sidebar-sub-header level3"><a href="/database/InnoDB/#_5。4-b-树索引" class="sidebar-link">5。4 B+树索引</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/database/InnoDB/#第六章-锁" class="sidebar-link">第六章 锁</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/database/InnoDB/#_6-1-lock与latch" class="sidebar-link">6.1 lock与latch</a></li><li class="sidebar-sub-header level3"><a href="/database/InnoDB/#_6-2-innodb中的锁" class="sidebar-link">6.2 InnoDB中的锁</a></li><li class="sidebar-sub-header level4"><a href="/database/InnoDB/#共享排他锁" class="sidebar-link">共享排他锁</a></li><li class="sidebar-sub-header level4"><a href="/database/InnoDB/#事务隔离级别" class="sidebar-link">事务隔离级别</a></li></ul></li></ul></li><li><a href="/pages/f7b3fe/" class="sidebar-link">MySQL基本使用</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Redis</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=%E6%95%B0%E6%8D%AE%E5%BA%93" title="分类" data-v-06225672>数据库</a></li><li data-v-06225672><a href="/categories/?category=MySQL" title="分类" data-v-06225672>MySQL</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/zzoxi" target="_blank" title="作者" class="beLink" data-v-06225672>zzoxi</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-03-14</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">mysql<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="innodb引擎"><a href="#innodb引擎" class="header-anchor">#</a> InnoDB引擎</h1> <h2 id="第一章-mysql简介"><a href="#第一章-mysql简介" class="header-anchor">#</a> 第一章 MySQL简介</h2> <h3 id="_1-1-mysql体系结构"><a href="#_1-1-mysql体系结构" class="header-anchor">#</a> 1.1 MySQL体系结构</h3> <div class="custom-block tip"><p class="custom-block-title">我的提示</p> <p>这是一条提示</p></div> <p>MySQL由以下几部分组成
连接池、管理服务和工具组件、SQL接口组件、查询分析器组件、优化器组件、缓冲组件、插件式存储引擎、物理文件。
MySQL区别于其他数据库的最重要的一个特点是插件式的表存储引擎。</p> <h3 id="_1-2-mysql存储引擎"><a href="#_1-2-mysql存储引擎" class="header-anchor">#</a> 1.2 MySQL存储引擎</h3> <h4 id="innodb与myisam区别"><a href="#innodb与myisam区别" class="header-anchor">#</a> InnoDB与MyISAM区别</h4> <p>InnoDB支持事务，特点是行锁设计、支持外键。使用MVCC获得高并发，实现了标准4种隔离级别。
MyISAM不支持事务，表锁设计，支持全文索引。缓冲池只缓存索引文件，而不缓冲数据文件。</p> <h2 id="第二章-innodb存储引擎"><a href="#第二章-innodb存储引擎" class="header-anchor">#</a> 第二章 InnoDB存储引擎</h2> <h3 id="_1-1-概述"><a href="#_1-1-概述" class="header-anchor">#</a> 1.1 概述</h3> <p>特点：行锁设计、支持MVCC、支持外键、提供一致性非锁定读（？）</p> <h3 id="_2-3-innodb体系架构"><a href="#_2-3-innodb体系架构" class="header-anchor">#</a> 2.3 InnoDB体系架构</h3> <p>主要是后台线程与内存池</p> <h4 id="后台线程"><a href="#后台线程" class="header-anchor">#</a> 后台线程</h4> <p>1、Master Thread
2、IO Thread
InnoDB中大量使用了AIO来处理IO请求，极大提高数据库的性能。
3、Purge Thread</p> <h4 id="内存池"><a href="#内存池" class="header-anchor">#</a> 内存池</h4> <p>1、缓冲池
2、LRU
缓冲池是通过LRU（最近最少使用）算法来管理，最频繁使用的页在LRU列表的前端，最少使用的页在LRU列表后端。
InnoDB对传统的LRU算法做了一些优化，LRU列表中加入了midpoint位置。新读取到的页放进midpoint位置。
为什么要这样做？
一些操作如索引或数据扫描操作，需要访问表中许多页，甚至全部页。如果放在首部，非常可能将热点数据也从列表中顶掉移除。
引入了一个参数innodb_old_blocks_time 表示页读取到mid位置后等待多久才会被加入到LRU的热端，设置为0避免热点数据刷出</p> <p>数据库刚启动时，LRU列表为空，这些页都存放在Free列表中，当需要从缓冲池中分页时，首先从Free列表中查找是否有可用的空闲页，若有则将该页从Free列表中删除，放入到LRU列表。
LRU列表的old部分加入到new部分时，此时的操作叫 page made young。</p> <p>3、重做日志缓冲</p> <h2 id="文件"><a href="#文件" class="header-anchor">#</a> 文件</h2> <h3 id="_3-1-参数文件"><a href="#_3-1-参数文件" class="header-anchor">#</a> 3.1 参数文件</h3> <h3 id="_3-2-日志文件"><a href="#_3-2-日志文件" class="header-anchor">#</a> 3.2 日志文件</h3> <p>常见的日志文件主要有错误日志、二进制日志（binlog）、慢查询日志（slow query log）</p> <h2 id="第四章-表"><a href="#第四章-表" class="header-anchor">#</a> 第四章 表</h2> <h3 id="_4-1-索引组织表"><a href="#_4-1-索引组织表" class="header-anchor">#</a> 4.1 索引组织表</h3> <p>InnoDB引擎中，表都是按照主键顺序组织存放的，这种存储方式的表称为索引组织表。
如果创建表时没有显示定义主键，InnoDB会首先判断是否有非空的唯一索引，如果有，则该列为主键。如不存在，InnoDB引擎自动创建一个6字节大小的指针。</p> <h3 id="_4-2-innodb逻辑存储结构"><a href="#_4-2-innodb逻辑存储结构" class="header-anchor">#</a> 4.2 InnoDB逻辑存储结构</h3> <p>所有数据都被逻辑地存放在一个空间中，称为表空间。表空间又由段、区、页组成。</p> <h4 id="_4-2-1-表空间"><a href="#_4-2-1-表空间" class="header-anchor">#</a> 4.2.1 表空间</h4> <p>默认情况下InnoDB存储引擎有一个共享表空间ibdata1，用户可以启用参数innodb_file_per_table,每张表内的数据单独放到一个表空间。</p> <h4 id="_4-2-2-段"><a href="#_4-2-2-段" class="header-anchor">#</a> 4.2.2 段</h4> <p>常见的段有数据段、索引段、回滚段。
数据即索引，索引及数据。数据段为B+树的叶子节点，索引段为B+树的非索引节点。</p> <h4 id="_4-2-3-区"><a href="#_4-2-3-区" class="header-anchor">#</a> 4.2.3 区</h4> <p>区时连续页组成的空间，InnoDB页默认16KB、一个区大小为1MB，一个区中一共有64个连续的页
InnoDB 1.0.x后裔i纳入压缩页，页的大小可以为2K、4K、8K。</p> <p>问题？表的大小不应该至少是1MB吗？一个区的大小
实际上用户启用innodb_file_per_table,创建表的默认大小时96KB，是因为每个段开始时，先用32个页大小的碎片页来存放数据，在使用完这些页后才是64个连续页的申请。这样做的好处是对于一些小标，开始时申请较少的空间，节省磁盘开销。
用完32个随拍你也后，新的页会采用区的方式进行空间申请，可能一次申请几个区。</p> <h4 id="_4-2-4-页"><a href="#_4-2-4-页" class="header-anchor">#</a> 4.2.4 页</h4> <p>页是InnoDB磁盘管理的最小单位。
常见的页有数据页（B-tree Node）、undo页（undoLog Page）、系统页（System Page）、事务数据页（Transaction system Page）...</p> <h4 id="_4-2-5-行"><a href="#_4-2-5-行" class="header-anchor">#</a> 4.2.5 行</h4> <p>InnoDB存储引擎是面向行的，数据是按行存放。每个页存放的行记录有硬性定义，最多允许存放16KB/2（即8192行）减去200行=7992行记录</p> <h3 id="_4-3-innodb行记录格式"><a href="#_4-3-innodb行记录格式" class="header-anchor">#</a> 4.3 InnoDB行记录格式</h3> <p>意味着页中保存着一行行的数据
每个行数据中有两个字节代表next_recorder表示下一个记录的偏移量，InnoDB存储引擎在页内部通过一种链表的结构来串连各个行记录</p> <p>疑问？Null标志位只有8位，若第10列是null，怎么标志？</p> <h4 id="_4-3-3-行溢出数据"><a href="#_4-3-3-行溢出数据" class="header-anchor">#</a> 4.3.3 行溢出数据</h4> <p>VARCHAR（N）中的N指的是字符的长度
文档中说明VARCHAR类型最大支持65535，单位是字节。
还需要注意的是，MySQL官方手册中定义的65535长度是指所有VARCHAR列长度总和，如果列的长度总和超出这个长度，依然无法创建。
当发生行溢出时，数据存放在页类型为Uncompress BLOB页中。
每个页中至少应该有两条行记录（否则失去了B+ Tree的意义，变成链表）
因此，如果页中只能存放一条记录，InnoDB存储引擎会自动将行数据存放到溢出页中。</p> <p>对于TEXT或BLOB数据，放在数据页中还是BLOB中和VARCHAR一样，取决于是否能保证一个页至少能存放两条记录。</p> <h4 id="_4-3-5-char的行结构存储"><a href="#_4-3-5-char的行结构存储" class="header-anchor">#</a> 4.3.5 CHAR的行结构存储</h4> <h3 id="_4-4-innodb数据页结构"><a href="#_4-4-innodb数据页结构" class="header-anchor">#</a> 4.4 InnoDB数据页结构</h3> <p>InnoDB数据页由以下七个部分组成，</p> <h2 id="第五章-索引与算法"><a href="#第五章-索引与算法" class="header-anchor">#</a> 第五章 索引与算法</h2> <h3 id="_5-1-innodb索引概述"><a href="#_5-1-innodb索引概述" class="header-anchor">#</a> 5.1 InnoDB索引概述</h3> <ul><li>B+树索引</li> <li>全文索引</li> <li>哈希索引</li></ul> <p>B+是找到所在的页，数据库把页读入到内存，再到内存中查找得到数据。
哈希索引是自适应的，InnoDB会根据表的使用情况自动为表生成哈希索引，不能人为干预？</p> <h3 id="_5-2-数据结构与算法"><a href="#_5-2-数据结构与算法" class="header-anchor">#</a> 5.2 数据结构与算法</h3> <p>Page Directory中的槽？</p> <h3 id="_5-3-b-树"><a href="#_5-3-b-树" class="header-anchor">#</a> 5.3 B+树</h3> <h3 id="_5。4-b-树索引"><a href="#_5。4-b-树索引" class="header-anchor">#</a> 5。4 B+树索引</h3> <p>B+树索引可以分为聚集索引（clustered index）和辅助索引（secondary index）。内部都是B+树，叶子节点存放着所有数据。不同之处在于，叶子节点存放的是否是一整行的信息</p> <p>聚集索引
InnoDB存储引擎表是索引组织表？</p> <h2 id="第六章-锁"><a href="#第六章-锁" class="header-anchor">#</a> 第六章 锁</h2> <h3 id="_6-1-lock与latch"><a href="#_6-1-lock与latch" class="header-anchor">#</a> 6.1 lock与latch</h3> <p>latch一般被称为轻量级锁，InnoDB引擎中可以分为mutex(互斥量)与rwlock（读写锁）作用对象是线程，目的保证并发线程操作临界资源的正确性，无死锁检测。
lock的对象是事务，锁定数据库对象如表、页、行。
一般仅在commit或rollback后释放，有死锁机制。</p> <h3 id="_6-2-innodb中的锁"><a href="#_6-2-innodb中的锁" class="header-anchor">#</a> 6.2 InnoDB中的锁</h3> <h4 id="共享排他锁"><a href="#共享排他锁" class="header-anchor">#</a> 共享排他锁</h4> <p>共享锁（S Lock），允许事务读一行数据
排他锁（X Lock），允许事务删除或更新一行数据
排他锁与共享锁的兼容性表格</p> <p>除此之外，InnoDB存储引擎支持多粒度锁定，一种额外的所方式，称为意向锁。？？？
意向共享锁（IS Lock）
意向排他锁（IX Lock）
特殊：S与IX不兼容</p> <h4 id="事务隔离级别"><a href="#事务隔离级别" class="header-anchor">#</a> 事务隔离级别</h4> <p>4种
Read Uncommitted（未提交读）---可能导致脏读、不可重复读、幻读
最低的隔离级别，允许读取未提交事务的数据。
Read Committed（提交读）---阻止脏读
允许读取并发事务已提交的数据。
Repeatable read（可重复读） --- 阻止脏读和不可重复读
多次读结果都一样？
SERIALIZABLE（串行化）
实现ACID、</p></div></div> <!----> <div class="page-edit"><!----> <!----> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><!----> <a href="/pages/f7b3fe/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">MySQL基本使用</div></a></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/pages/f7b3fe/">MySQL基本使用</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/44ebb8/"><div>
            JAVA并发编程
            <!----></div></a> <span class="date">03-16</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/f7b3fe/"><div>
            MySQL基本使用
            <!----></div></a> <span class="date">03-15</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/a3ffc2/"><div>
            java
            <!----></div></a> <span class="date">03-14</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:zzoxi925@gmail.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/zzoxi" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2023-2023
    <span>ZZ | MIT License</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.510ffd02.js" defer></script><script src="/assets/js/2.5c750f37.js" defer></script><script src="/assets/js/7.45caa363.js" defer></script>
  </body>
</html>
